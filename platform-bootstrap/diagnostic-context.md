# Kerberos Authentication Diagnostic Context

**Generated:** 2025-10-15 11:48:26 CDT
**Purpose:** Self-contained diagnostic information for troubleshooting Kerberos/SQL authentication issues

---

## ü§ñ LLM Instructions

This diagnostic report contains comprehensive information about a Kerberos authentication environment.
Use this information to help diagnose and resolve authentication issues with SQL Server or other Kerberized services.
All necessary context is included below - no additional information should be needed.

---

## üìã Environment Overview

### System Information
```
Hostname: Troubladore-W11
OS: Linux 6.6.87.1-microsoft-standard-WSL2
Architecture: x86_64
Distribution: Ubuntu 24.04.3 LTS
Environment: Native Linux
User: troubladore
Groups: troubladore adm cdrom sudo dip plugdev users scard docker
```

### Docker Environment
```
Docker: 
The command 'docker' could not be found in this WSL 2 distro.
We recommend to activate the WSL integration in Docker Desktop settings.

For details about using Docker Desktop with WSL 2, visit:

https://docs.docker.com/go/wsl2/
Docker Compose: 
The command 'docker' could not be found in this WSL 2 distro.
We recommend to activate the WSL integration in Docker Desktop settings.

For details about using Docker Desktop with WSL 2, visit:

https://docs.docker.com/go/wsl2/

Not installed
Kerberos Sidecar: Not running
```

## üîë Kerberos Configuration

### Ticket Status
```
KRB5CCNAME: FILE:/tmp/krb5cc_test_252249

klist: Not installed (cannot check tickets)
```

### Kerberos Configuration File
```
No /etc/krb5.conf found
```

## üåê Network Configuration

### DNS Configuration
```
Nameservers:
nameserver 10.255.255.254

Search domains:
None configured
```

### Time Synchronization (Critical for Kerberos)
```
Current time: Wed Oct 15 11:48:26 AM CDT 2025
UTC time: Wed Oct 15 04:48:26 PM UTC 2025

               Local time: Wed 2025-10-15 11:48:26 CDT
           Universal time: Wed 2025-10-15 16:48:26 UTC
System clock synchronized: yes
              NTP service: active
```

## üóÑÔ∏è SQL Server Tools

```
sqlcmd: NOT INSTALLED

Installation required for SQL Server testing
```

## üìä Recent Diagnostic Tests

No recent test results found.
Run './krb5-auth-test.sh -v' to generate detailed diagnostics.

## üîç Automated Analysis

### Issue Detection

‚ùå **No valid Kerberos ticket**
   - Impact: Cannot authenticate to Kerberized services
   - Resolution: Run `kinit username@DOMAIN.COM`

‚ö†Ô∏è  **Kerberos sidecar not running**
   - Impact: Containers cannot receive Kerberos tickets
   - Resolution: Run `make platform-start` or `docker compose up -d`

‚ö†Ô∏è  **SQL Server tools not installed**
   - Impact: Cannot test SQL Server authentication
   - Resolution: Install mssql-tools18 package


## üìö Context for LLM Analysis

### What This System Does

This is a Kerberos ticket-sharing sidecar system that allows Docker containers to use
the host's Kerberos tickets for authentication to SQL Server and other Kerberized services.
The architecture involves:

1. **Host System**: Obtains Kerberos tickets via `kinit`
2. **Sidecar Container**: Monitors and shares tickets to other containers
3. **Application Containers**: Mount shared ticket cache for authentication

### Common Issues and Solutions

1. **"No credentials cache found"**
   - User hasn't run `kinit`
   - KRB5CCNAME points to wrong location

2. **"Cannot authenticate using Kerberos"**
   - SQL Server SPN not registered
   - Ticket not forwardable (`kinit -f`)

3. **"Login timeout expired"**
   - Network connectivity issue
   - Wrong SQL Server hostname
   - Not on VPN

### Next Steps for Troubleshooting

Based on the diagnostic data above, an LLM should:
1. Identify which component is failing (Kerberos, Network, SQL, Docker)
2. Suggest specific commands to gather more information
3. Provide step-by-step resolution instructions
4. Recommend verification commands to confirm the fix

---

## ü§ù How to Use This Report

### For Humans
Copy this entire report and paste it into ChatGPT or Claude with your question.
Example: "Based on this diagnostic context, why am I getting 'Login failed for user'?"

### For Developers
This report structure is designed to be parsed by MCP-compatible agents in the future.
JSON output mode is available: `./diagnostics/generate-diagnostic-context.sh json diagnostic-context.json`

### For Support Teams
This report contains all necessary information for remote troubleshooting without
requiring additional back-and-forth for context gathering.

---

*Generated by generate-diagnostic-context.sh v1.0.0*
