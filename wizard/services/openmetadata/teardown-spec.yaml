service: openmetadata
version: "1.0"
description: "OpenMetadata teardown"
requires: []

steps:
  - id: show_details_header
    type: display
    prompt: |

      ────────────────────────────────────────────────────────
        OpenMetadata Removal Options
      ────────────────────────────────────────────────────────

    next: stop_service

  - id: stop_service
    type: action
    action: openmetadata.stop_service
    next: remove_images_question

  - id: remove_images_question
    type: boolean
    prompt: "Remove OpenMetadata Docker images?"
    state_key: services.openmetadata.teardown.remove_images
    default_value: false
    next:
      when_value:
        true: remove_images_action
        false: remove_volumes_question

  - id: remove_images_action
    type: action
    action: openmetadata.remove_images
    next: remove_volumes_question

  - id: remove_volumes_question
    type: boolean
    prompt: "Remove OpenMetadata data volumes (data will be lost)?"
    state_key: services.openmetadata.teardown.remove_volumes
    default_value: false
    next:
      when_value:
        true: remove_volumes_action
        false: remove_config_question

  - id: remove_volumes_action
    type: action
    action: openmetadata.remove_volumes
    next: remove_config_question

  - id: remove_config_question
    type: boolean
    prompt: "Remove from platform configuration (custom settings will be forgotten)?"
    state_key: services.openmetadata.teardown.remove_config
    default_value: false
    next:
      when_value:
        true: clean_config
        false: finish

  - id: clean_config
    type: action
    action: openmetadata.clean_config
    next: finish
