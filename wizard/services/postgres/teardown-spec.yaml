service: postgres
version: 1.0
description: "PostgreSQL database teardown"
requires: []

steps:
  - id: postgres_teardown_confirm
    type: boolean
    prompt: "Are you sure you want to tear down PostgreSQL? (y/n):"
    state_key: services.postgres.teardown.confirm
    default_value: false
    next:
      when_value:
        true: stop_service
        false: finish

  - id: stop_service
    type: action
    action: postgres.teardown.stop_service
    next: postgres_remove_volumes

  - id: postgres_remove_volumes
    type: boolean
    prompt: "Remove PostgreSQL data volumes? (y/n):"
    state_key: services.postgres.teardown.remove_volumes
    default_value: false
    next:
      when_value:
        true: remove_volumes_action
        false: postgres_remove_images

  - id: remove_volumes_action
    type: action
    action: postgres.teardown.remove_volumes
    next: postgres_remove_images

  - id: postgres_remove_images
    type: boolean
    prompt: "Remove PostgreSQL Docker images? (y/n):"
    state_key: services.postgres.teardown.remove_images
    default_value: false
    next:
      when_value:
        true: remove_images_action
        false: clean_config

  - id: remove_images_action
    type: action
    action: postgres.teardown.remove_images
    next: clean_config

  - id: clean_config
    type: action
    action: postgres.teardown.clean_config
    next: finish
