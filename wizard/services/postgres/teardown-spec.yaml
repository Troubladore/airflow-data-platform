service: postgres
version: 1.0
description: "PostgreSQL database teardown"
requires: []

steps:
  - id: postgres_teardown_confirm
    type: boolean
    prompt: "Remove PostgreSQL database service?"
    state_key: services.postgres.teardown.confirm
    default_value: false
    next:
      when_value:
        true: show_postgres_details_header
        false: finish

  - id: show_postgres_details_header
    type: display
    prompt: |

      ────────────────────────────────────────────────────────
        PostgreSQL Removal Details
      ────────────────────────────────────────────────────────

    next: remove_container_action

  - id: remove_container_action
    type: action
    action: postgres.teardown.stop_service
    next: postgres_remove_images

  - id: postgres_remove_images
    type: boolean
    prompt: "Remove PostgreSQL Docker images?"
    state_key: services.postgres.teardown.remove_images
    default_value: false
    next:
      when_value:
        true: remove_images_action
        false: postgres_remove_volumes

  - id: remove_images_action
    type: action
    action: postgres.teardown.remove_images
    next: postgres_remove_volumes

  - id: postgres_remove_volumes
    type: boolean
    prompt: "Remove PostgreSQL data volumes (data will be lost)?"
    state_key: services.postgres.teardown.remove_volumes
    default_value: false
    next:
      when_value:
        true: remove_volumes_action
        false: clean_config

  - id: remove_volumes_action
    type: action
    action: postgres.teardown.remove_volumes
    next: clean_config

  - id: clean_config
    type: action
    action: postgres.teardown.clean_config
    next: finish
