service: kerberos
version: "1.0"
description: "Kerberos authentication service setup"

provides:
  - kerberos

requires: []

steps:
  - id: domain_input
    type: string
    state_key: services.kerberos.domain
    default_from: services.kerberos.domain
    prompt: "Enter Kerberos domain (e.g., COMPANY.COM):"
    validator: kerberos.validate_domain
    next: image_input

  - id: image_input
    type: string
    state_key: services.kerberos.image
    default_from: services.kerberos.image
    prompt: "Enter Docker image for Kerberos (e.g., ubuntu:22.04):"
    default_value: "ubuntu:22.04"
    validator: kerberos.validate_image_url
    next:
      when_changed: use_prebuilt_input
      when_unchanged: test_kerberos_action

  - id: use_prebuilt_input
    type: boolean
    state_key: services.kerberos.use_prebuilt
    default_from: services.kerberos.use_prebuilt
    prompt: "Is this a prebuilt image with Kerberos packages already installed?"
    default_value: false
    next: test_kerberos_action

  - id: test_kerberos_action
    type: action
    action: kerberos.test_kerberos
    next: save_config_action

  - id: save_config_action
    type: action
    action: kerberos.save_config
    next: start_service_action

  - id: start_service_action
    type: action
    action: kerberos.start_service
    next: finish
