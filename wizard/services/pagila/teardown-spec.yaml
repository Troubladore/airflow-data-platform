service: pagila
version: 1.0
description: "Teardown Pagila sample database and cleanup"

steps:
  - id: show_details_header
    type: display
    prompt: |

      ────────────────────────────────────────────────────────
        Pagila Removal Options
      ────────────────────────────────────────────────────────

    next: remove_container_action

  - id: remove_container_action
    type: action
    action: pagila.stop_service
    next: remove_images_question

  - id: remove_images_question
    type: boolean
    prompt: "Remove Pagila Docker images?"
    state_key: services.pagila.teardown.remove_images
    default_value: false
    next:
      when_value:
        true: remove_images_action
        false: remove_repo_question

  - id: remove_images_action
    type: action
    action: pagila.remove_images
    next: remove_repo_question

  - id: remove_repo_question
    type: boolean
    prompt: "Remove cloned repository folder?"
    state_key: services.pagila.teardown.remove_repo
    default_value: false
    next:
      when_value:
        true: remove_repo_action
        false: remove_config_question

  - id: remove_repo_action
    type: action
    action: pagila.remove_repo
    next: remove_database_data_question

  - id: remove_database_data_question
    type: boolean
    prompt: "Remove Pagila database data (data will be lost)?"
    state_key: services.pagila.teardown.remove_database_data
    default_value: false
    next:
      when_value:
        true: remove_database_action
        false: remove_config_question

  - id: remove_database_action
    type: action
    action: pagila.drop_database
    next: remove_config_question

  - id: remove_config_question
    type: boolean
    prompt: "Remove from platform configuration (custom settings will be forgotten)?"
    state_key: services.pagila.teardown.remove_config
    default_value: false
    next:
      when_value:
        true: remove_config_action
        false: finish

  - id: remove_config_action
    type: action
    action: pagila.clean_config
    next: finish
