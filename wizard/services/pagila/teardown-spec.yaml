service: pagila
version: 1.0
description: "Teardown Pagila sample database and cleanup"

steps:
  - id: pagila_teardown_confirm
    type: boolean
    prompt: "Remove Pagila?"
    state_key: services.pagila.teardown.confirm
    default_value: false
    next:
      when_value:
        true: show_details_header
        false: finish

  - id: show_details_header
    type: display
    prompt: |

      ────────────────────────────────────────────────────────
        Pagila Removal Options
      ────────────────────────────────────────────────────────

    next: remove_repo_question

  - id: remove_repo_question
    type: boolean
    prompt: "Remove cloned repository folder?"
    state_key: services.pagila.teardown.remove_repo
    default_value: false
    next:
      when_value:
        true: remove_repo_action
        false: remove_database_question

  - id: remove_repo_action
    type: action
    action: pagila.remove_repo
    next: remove_database_question

  - id: remove_database_question
    type: boolean
    prompt: "Remove database and data (cannot be recovered)?"
    state_key: services.pagila.teardown.remove_database
    default_value: false
    next:
      when_value:
        true: remove_database_action
        false: remove_config_question

  - id: remove_database_action
    type: action
    action: pagila.drop_database
    next: remove_config_question

  - id: remove_config_question
    type: boolean
    prompt: "Remove from platform configuration (prevents recreation on next setup)?"
    state_key: services.pagila.teardown.remove_config
    default_value: false
    next:
      when_value:
        true: remove_config_action
        false: finish

  - id: remove_config_action
    type: action
    action: pagila.clean_config
    next: finish
